<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="/bower_components/polymer/polymer-element.html">
<!-- <link rel="import" href="/bower_components/note-app-elements/na-elements.html"> -->
<link rel="import" href="/bower_components/polymerfire/firebase-query.html">
<link rel="import" href="/bower_components/polymerfire/firebase-document.html">
<link rel="import" href="/bower_components/iron-list/iron-list.html" />
<link rel="import" href="/bower_components/iron-image/iron-image.html" />



<link rel="import" href="shared-styles.html">

<dom-module id="my-view1">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
        width: 100%;
        padding: 0px;
      }

      ul {
        /*list-style-type: none;*/
        padding: 0px;
      }

      h3 {
        font: bold 20px/1.5 Helvetica, Verdana, sans-serif;
      }

      li iron-image {
        float: left;
        margin: 0 15px 0 0;
      }

/*      li p {
        font: 200 12px/1.5 Georgia, Times New Roman, serif;
      }
*/
      li {
        padding: 10px;
        overflow: auto;
      }

      li:hover {
        background: var(--paper-deep-purple-900);
        opacity: 20%;
        cursor: pointer;
      }

    </style>

    <firebase-auth
        id="auth"
        app-name="ddsecrets"
        provider="google"
        signed-in="{{signedIn}}"
        user="{{user}}">
    </firebase-auth>

<!--     <firebase-document
      id="query"
      app-name="ddsecrets"
      path="/users"
      data="{{data}}">
    </firebase-document>
 -->
    <firebase-query
        id="query"
        app-name="ddsecrets"
        path="/users"
        data="{{fireData}}">
    </firebase-query>

    <ul>
      <template is="dom-repeat" items="[[fireData]]" as="item">
        <li on-click="dothing">
          <iron-image class="circle" style="width:50px; height:50px;" sizing="cover" src="[[item.imageURL]]"></iron-image>
          <h3>[[item.name]]</h3>        
        </li>          
      </template>
    </ul>


  </template>

  <script>
    // class MyView1 extends Polymer.Element {
    //   static get is() { return 'my-view1'; }



    // }

    Polymer({
  
      is: 'my-view1',

      behaviors: [Polymer.Element],

      properties: {
        uid: String,
        url: String,
        // data: {
        //   type: Object,
        //   observer: 'dataChanged'
        // },
        fireData: Array
      },
      _toArray: function(obj) {
          return Object.keys(obj).map(function(key) {
              return {
                  name: key,
                  value: obj[key]
              };
          });
      },
      // ready: function(){
      //   console.log("query", this.$.query.data);
      //   // thie.$.query.path = /users/ + this.$..
      // }
      dataChanged: function(newData, oldData) {
        console.log("newData", newData);
        console.log("oldData", oldData);          

        
        var players = []
        if (newData) {
          for (var key in newData) {
            var obj = newData[key];

            var temp = {};
            for (var prop in obj) {
              temp[prop] = obj[prop]; 
              console.log(obj[prop]);
            }
            players.push(temp);
          }
          // console.log("playername", players[0].name);
          this.fireData = players;
          // this.set('fireData', players)
          // console.log("url", this.$.app);
          // this.$.ajax.url 
          // this.set('fireData', newData.D6kTdmHm7cgkX0uWxPoJoEJWtyi1);
          // console.log('fireData', this.$.fireData);
          // console.log(newData.D6kTdmHm7cgkX0uWxPoJoEJWtyi1);
        }
      },
      dothing: function() {
        console.log("thing")
      }

    });


    // window.customElements.define(MyView1.is, MyView1);
  </script>
</dom-module>
